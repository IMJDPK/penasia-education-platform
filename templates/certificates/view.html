{% extends "base.html" %}

{% block title %}Certificate - {{ certificate.course.title }} - PenAsia LMS{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <!-- Certificate Display -->
            <div class="card shadow-lg border-warning">
                <div class="card-body p-5 text-center certificate-design">
                    <!-- Header -->
                    <div class="mb-4">
                        <img src="{{ url_for('static', filename='images/logos/penasia_logo.png') }}" alt="PenAsia Logo" height="80" class="mb-3">
                        <h2 class="text-warning mb-0">PenAsia Continuing Education Centre</h2>
                        <p class="text-muted">盈亞持續教育中心</p>
                    </div>
                    
                    <!-- Certificate Title -->
                    <div class="mb-4 pt-4 pb-4 border-top border-bottom border-warning">
                        <h1 class="display-4 text-primary mb-3">Certificate of Completion</h1>
                        <p class="lead">This is to certify that</p>
                        <h3 class="text-dark mb-3">{{ certificate.user.full_name }}</h3>
                        <p class="lead">has successfully completed</p>
                        <h4 class="text-warning">{{ certificate.course.title }}</h4>
                        <p class="text-muted">Course Code: {{ certificate.course.course_code }}</p>
                    </div>
                    
                    <!-- Details -->
                    <div class="row mt-4 mb-4">
                        <div class="col-md-4">
                            <p class="text-muted mb-1">Completion Date</p>
                            <p><strong>{{ certificate.completion_date.strftime('%B %d, %Y') }}</strong></p>
                        </div>
                        <div class="col-md-4">
                            <p class="text-muted mb-1">Final Grade</p>
                            <p><strong>{{ certificate.display_grade }}</strong></p>
                        </div>
                        <div class="col-md-4">
                            <p class="text-muted mb-1">Honors</p>
                            <p><strong class="{{ 'text-success' if certificate.honors == 'Distinction' else 'text-info' if certificate.honors == 'Merit' else '' }}">
                                {{ certificate.honors or 'Pass' }}
                            </strong></p>
                        </div>
                    </div>
                    
                    {% if certificate.attendance_percentage %}
                    <div class="mb-4">
                        <p class="text-muted mb-1">Attendance Rate</p>
                        <p><strong>{{ certificate.attendance_percentage }}%</strong></p>
                    </div>
                    {% endif %}
                    
                    <!-- Certificate Number -->
                    <div class="mt-5">
                        <p class="text-muted mb-1">Certificate Number</p>
                        <h5 class="text-dark">{{ certificate.certificate_number }}</h5>
                        <p class="small text-muted mt-3">
                            Issued on {{ certificate.issue_date.strftime('%B %d, %Y') }}
                        </p>
                    </div>
                    
                    <!-- Verification Code -->
                    <div class="mt-4 p-3 bg-light rounded">
                        <p class="mb-1 small text-muted">Verification Code</p>
                        <code class="text-dark">{{ certificate.verification_code }}</code>
                        <p class="mb-0 small text-muted mt-2">
                            <i class="fas fa-shield-alt me-1"></i>Verify this certificate at: 
                            <a href="{{ certificate.verification_url }}" target="_blank">{{ request.host_url }}verify-certificate/{{ certificate.verification_code }}</a>
                        </p>
                    </div>
                    
                    <!-- Footer -->
                    <div class="mt-5 pt-4 border-top">
                        <div class="row">
                            <div class="col-md-12">
                                <p class="small text-muted mb-1">Education License No. 593958</p>
                                <p class="small text-muted">
                                    1/F, Block C, Cho Yiu Centre, Kwai Chung, Hong Kong<br>
                                    (852) 2529 6138 | enquiry@penasia.edu.hk
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="text-center mt-4">
                <button onclick="window.print()" class="btn btn-primary me-2">
                    <i class="fas fa-print me-1"></i>Print Certificate
                </button>
                <button onclick="copyVerificationCode()" class="btn btn-outline-secondary me-2">
                    <i class="fas fa-copy me-1"></i>Copy Verification Code
                </button>
                <a href="{{ url_for('my_certificates') }}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-1"></i>Back to Certificates
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.certificate-design {
    background: linear-gradient(to bottom, #ffffff, #f8f9fa);
    border: 5px double #D4AF37;
}

@media print {
    .btn, nav, footer, .navbar-premium {
        display: none !important;
    }
    .certificate-design {
        border: 3px double #D4AF37;
        page-break-inside: avoid;
    }
}
</style>

<script>
function copyVerificationCode() {
    const code = '{{ certificate.verification_code }}';
    navigator.clipboard.writeText(code).then(function() {
        alert('Verification code copied to clipboard!');
    }, function(err) {
        console.error('Could not copy text: ', err);
    });
}
</script>
{% endblock %}
